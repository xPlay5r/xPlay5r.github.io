<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞—Ä—Ç–æ—á–∫–∏ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            margin: 0;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header h2 {
            margin: 0;
            font-size: 2em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            margin: 10px 0 0 0;
            font-size: 1.2em;
            opacity: 0.9;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ñ–ª–µ—à–∫–∞—Ä—Ç–æ—á–µ–∫ */
        .cards-container {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            position: relative;
        }

        .card {
            perspective: 1000px;
            height: 300px;
            width: 400px;
            margin: 0 auto;
        }

        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            cursor: pointer;
        }

        .card.flipped .card-inner {
            transform: rotateY(180deg);
        }

        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8em;
            font-weight: bold;
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
            border: 3px solid rgba(255,255,255,0.2);
            padding: 15px;
            box-sizing: border-box;
            text-align: center;
            line-height: 1.2;
        }

        .card-front {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
            color: #2d3748;
        }

        .card-back {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            color: #2d3748;
            transform: rotateY(180deg);
        }

        .card:hover .card-inner {
            transform: scale(1.05);
        }

        .card.flipped:hover .card-inner {
            transform: rotateY(180deg) scale(1.05);
        }

        .card-navigation {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-top: 30px;
        }

        .nav-btn {
            background: rgba(255,255,255,0.3);
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 1.5em;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .nav-btn:hover {
            background: rgba(255,255,255,0.5);
            transform: scale(1.1);
        }

        .card-counter {
            color: white;
            font-size: 1.2em;
            background: rgba(0,0,0,0.3);
            padding: 10px 20px;
            border-radius: 20px;
        }

        .controls {
            margin-top: 30px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .btn {
            padding: 12px 24px;
            font-size: 1em;
            border: none;
            border-radius: 25px;
            background: rgba(255,255,255,0.2);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.3);
        }

        .btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-next {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%) !important;
        }

        .btn-next:hover:not(:disabled) {
            background: linear-gradient(135deg, #38a169 0%, #2f855a 100%) !important;
        }

        .progress {
            margin-top: 20px;
            color: white;
            font-size: 1.1em;
            text-align: center;
            background: rgba(0,0,0,0.2);
            padding: 10px 20px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è */
        .test-section {
            width: 100%;
            max-width: 800px;
            margin-top: 40px;
            display: none;
        }

        .question-card {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            text-align: center;
        }

        .question-text {
            font-size: 1.5em;
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 25px;
        }

        .answer-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        .answer-option {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 15px;
            padding: 15px 20px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .answer-option:hover:not(.disabled) {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }

        .answer-option.correct {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            animation: correctAnswer 0.5s ease;
        }

        .answer-option.incorrect {
            background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
            animation: incorrectAnswer 0.5s ease;
        }

        .answer-option.disabled {
            pointer-events: none;
            opacity: 0.7;
        }

        @keyframes correctAnswer {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes incorrectAnswer {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
            100% { transform: translateX(0); }
        }

        .test-result {
            margin: 20px 0;
            font-size: 1.2em;
            font-weight: bold;
            min-height: 30px;
        }

        .test-result.correct {
            color: #38a169;
        }

        .test-result.incorrect {
            color: #e53e3e;
        }

        .test-progress {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255,255,255,0.9);
            padding: 15px 25px;
            border-radius: 15px;
            margin: 20px 0;
            color: #2d3748;
            font-weight: bold;
        }

        .test-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .final-result {
            text-align: center;
            padding: 40px 20px;
        }

        .result-emoji {
            font-size: 4em;
            margin-bottom: 20px;
            animation: bounce 1s infinite alternate;
        }

        @keyframes bounce {
            0% { transform: translateY(0px); }
            100% { transform: translateY(-10px); }
        }

        .result-title {
            font-size: 2em;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .result-score {
            font-size: 1.5em;
            margin-bottom: 30px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å–ª–æ–≤–∞ */
        .spelling-section {
            width: 100%;
            max-width: 800px;
            margin-top: 40px;
            display: none;
        }

        .spelling-container {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            text-align: center;
        }

        .spelling-question {
            font-size: 1.5em;
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 25px;
        }

        .spelling-area {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin: 30px 0;
            min-height: 60px;
        }

        .spelling-letter {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
            padding: 15px 20px;
            font-size: 1.2em;
            font-weight: bold;
            min-width: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .spelling-letter:hover:not(.used) {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .spelling-letter.used {
            background: #cbd5e0;
            cursor: default;
            transform: scale(0.9);
        }

        .spelling-letter.moving {
            animation: letterMove 0.5s ease-in-out;
        }

        .spelling-input {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin: 30px 0;
            min-height: 60px;
            background: rgba(255,255,255,0.5);
            border-radius: 15px;
            padding: 20px;
            border: 2px dashed #667eea;
        }

        .spelling-slot {
            background: rgba(255,255,255,0.8);
            border: 2px dashed #667eea;
            border-radius: 10px;
            width: 50px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            font-weight: bold;
            color: #2d3748;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .spelling-slot.filled {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border: 2px solid #667eea;
            transform: scale(1.05);
        }

        .spelling-slot:hover {
            background: rgba(255,255,255,0.9);
        }

        .spelling-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .spelling-result {
            margin: 20px 0;
            font-size: 1.2em;
            font-weight: bold;
            min-height: 30px;
            padding: 15px;
            border-radius: 10px;
        }

        .spelling-result.correct {
            color: #38a169;
            background: rgba(56, 161, 105, 0.1);
            animation: correctPulse 0.5s ease;
        }

        .spelling-result.incorrect {
            color: #e53e3e;
            background: rgba(229, 62, 62, 0.1);
        }

        @keyframes letterMove {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(0.9); }
        }

        @keyframes correctPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .auto-check {
            margin: 15px 0;
            font-size: 1em;
            color: #4a5568;
            font-style: italic;
        }

        @media (max-width: 768px) {
            .card {
                height: 250px;
                width: 300px;
            }
            
            .card-front, .card-back {
                font-size: 1.4em;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .header h2 {
                font-size: 1.5em;
            }

            .answer-options {
                grid-template-columns: 1fr;
            }
            
            .question-text {
                font-size: 1.3em;
            }
            
            .test-progress {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
            
            .question-card {
                padding: 20px;
            }

            .controls, .test-controls, .spelling-controls {
                flex-direction: column;
                align-items: center;
            }

            .btn {
                width: 250px;
            }
            
            .spelling-letter {
                padding: 12px 15px;
                min-width: 40px;
                font-size: 1.1em;
            }
            
            .spelling-slot {
                width: 40px;
                height: 50px;
            }
        }
    </style>
</head>
<body>
    <!-- –°–µ–∫—Ü–∏—è —Ñ–ª–µ—à–∫–∞—Ä—Ç–æ—á–µ–∫ -->
    <div id="flashcardsSection">
        <div class="header">
            <h1>üéØ Occasions. Module 1 D Spotlight-9</h1>
            <p>Click on the cards to see translation</p>
        </div>

        <div class="cards-container" id="cardsContainer"></div>

        <div class="card-navigation">
            <button class="nav-btn" onclick="prevCard()">‚Üê</button>
            <div class="card-counter" id="cardCounter">1 / 6</div>
            <button class="nav-btn" onclick="nextCard()">‚Üí</button>
        </div>

        <div class="controls">
            <button class="btn" onclick="flipAllCards()">üîÑ Turn over all the cards</button>
            <button class="btn" onclick="resetCards()">üîÉ Reset</button>
            <button class="btn" onclick="shuffleCards()">üé≤ Mix</button>
            <button class="btn" onclick="startTest()">üéØ Start the test</button>
            <button class="btn" onclick="startSpelling()">üî§ Spelling practice</button>
        </div>

        <div class="progress" id="progress">
            Learnt: 0 from 6 cards
        </div>
    </div>

    <!-- –°–µ–∫—Ü–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
    <div class="test-section" id="testSection">
        <div class="header">
            <h2>üéØ Test</h2>
            <p>Check your knowledge!</p>
        </div>
        
        <div class="test-container">
            <div class="question-card" id="questionCard">
                <div class="question-text" id="questionText"></div>
                <div class="answer-options" id="answerOptions"></div>
                <div class="test-result" id="testResult"></div>
                <button class="btn btn-next" id="nextBtn" onclick="nextQuestion()" style="display: none;">Next question</button>
            </div>
            
            <div class="test-progress">
                <div class="test-score" id="testScore">Right answers: 0 –∏–∑ 0</div>
                <div class="test-question-counter" id="questionCounter">Question 0 –∏–∑ 0</div>
            </div>
        </div>
        
        <div class="test-controls">
            <button class="btn" onclick="startTest()">üîÑ Start again</button>
            <button class="btn" onclick="showFlashcards()">üìö Back to cards</button>
        </div>
    </div>

    <!-- –°–µ–∫—Ü–∏—è —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å–ª–æ–≤–∞ -->
    <div class="spelling-section" id="spellingSection">
        <div class="header">
            <h2>üî§ Spelling practice</h2>
            <p>Make up words from letters!</p>
        </div>
        
        <div class="spelling-container">
            <div class="spelling-question" id="spellingQuestion"></div>
            <div class="auto-check" id="autoCheck">The answer will be checked automatically when all letters are placed</div>
            <div class="spelling-area" id="spellingArea"></div>
            <div class="spelling-input" id="spellingInput"></div>
            <div class="spelling-result" id="spellingResult"></div>
            <div class="spelling-controls">
                <button class="btn btn-next" id="spellingNextBtn" onclick="nextSpellingWord()" style="display: none;">Next word</button>
            </div>
        </div>
        
        <div class="test-progress">
            <div class="test-score" id="spellingScore">Right answers: 0 –∏–∑ 0</div>
            <div class="test-question-counter" id="spellingCounter">Word 0 –∏–∑ 0</div>
        </div>

        <div class="test-controls">
            <button class="btn" onclick="startSpelling()">üîÑ Start again</button>
            <button class="btn" onclick="showFlashcards()">üìö Back to cards</button>
        </div>
    </div>

    <script>
        const words = [
            { russian: '–≤–∑–≤–æ–ª–Ω–æ–≤–∞–Ω–Ω—ã–π', english: 'excited' },
            { russian: '–Ω–µ—Ä–≤–Ω—ã–π', english: 'nervous' },
            { russian: '–≤–æ—Å—Ö–∏—â–µ–Ω–Ω—ã–π', english: 'thrilled' },
            { russian: '–≤–æ—Å—Ç–æ—Ä–∂–µ–Ω–Ω—ã–π', english: 'enthusiastic' },
            { russian: '—É–¥–∏–≤–ª–µ–Ω–Ω—ã–π', english: 'surprised' },
            { russian: '–Ω–µ—Ç–µ—Ä–ø–µ–ª–∏–≤—ã–π', english: 'impatient' }
        ];

        let flippedCards = new Set();
        let currentQuestion = 0;
        let correctAnswers = 0;
        let testQuestions = [];
        let userAnswers = [];
        
        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å–ª–æ–≤
        let currentSpellingWord = 0;
        let spellingWords = [];
        let spellingCorrectAnswers = 0;
        let selectedLetters = [];
        let currentWordLetters = [];
        let isSpellingCorrect = false;

        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø–æ –∫–∞—Ä—Ç–æ—á–∫–∞–º
        let currentCardIndex = 0;

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø–æ –∫–∞—Ä—Ç–æ—á–∫–∞–º
        function showCard(index) {
            const cards = document.querySelectorAll('.card');
            cards.forEach(card => card.style.display = 'none');
            
            if (cards[index]) {
                cards[index].style.display = 'block';
                currentCardIndex = index;
                updateCardCounter();
            }
        }

        function nextCard() {
            if (currentCardIndex < words.length - 1) {
                showCard(currentCardIndex + 1);
            }
        }

        function prevCard() {
            if (currentCardIndex > 0) {
                showCard(currentCardIndex - 1);
            }
        }

        function updateCardCounter() {
            const counter = document.getElementById('cardCounter');
            counter.textContent = `${currentCardIndex + 1} / ${words.length}`;
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ñ–ª–µ—à–∫–∞—Ä—Ç–æ—á–µ–∫
        function createCards() {
            const container = document.getElementById('cardsContainer');
            container.innerHTML = '';
            
            words.forEach((word, index) => {
                const card = document.createElement('div');
                card.className = 'card';
                card.setAttribute('data-index', index);
                card.style.display = index === 0 ? 'block' : 'none';
                
                card.innerHTML = `
                    <div class="card-inner">
                        <div class="card-front">
                            ${word.russian}
                        </div>
                        <div class="card-back">
                            ${word.english}
                        </div>
                    </div>
                `;
                
                card.addEventListener('click', () => flipCard(card, index));
                container.appendChild(card);
            });
            
            updateCardCounter();
            updateProgress();
        }

        function flipCard(cardElement, index) {
            cardElement.classList.toggle('flipped');
            
            if (cardElement.classList.contains('flipped')) {
                flippedCards.add(index);
            } else {
                flippedCards.delete(index);
            }
            
            updateProgress();
        }

        function flipAllCards() {
            const cards = document.querySelectorAll('.card');
            cards.forEach((card, index) => {
                if (!card.classList.contains('flipped')) {
                    card.classList.add('flipped');
                    flippedCards.add(index);
                }
            });
            updateProgress();
        }

        function resetCards() {
            const cards = document.querySelectorAll('.card');
            cards.forEach(card => card.classList.remove('flipped'));
            flippedCards.clear();
            updateProgress();
        }

        function shuffleCards() {
            // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –º–∞—Å—Å–∏–≤ —Å–ª–æ–≤
            for (let i = words.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [words[i], words[j]] = [words[j], words[i]];
            }
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏
            flippedCards.clear();
            currentCardIndex = 0;
            createCards();
        }

        function updateProgress() {
            const progress = document.getElementById('progress');
            progress.textContent = `Learnt: ${flippedCards.size} from ${words.length} cards`;
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        function startTest() {
            // –°–∫—Ä—ã–≤–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ—Å—Ç
            document.getElementById('flashcardsSection').style.display = 'none';
            document.getElementById('testSection').style.display = 'block';
            document.getElementById('spellingSection').style.display = 'none';
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–µ—Å—Ç
            currentQuestion = 0;
            correctAnswers = 0;
            userAnswers = [];
            
            // –°–æ–∑–¥–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –¥–ª—è —Ç–µ—Å—Ç–∞
            testQuestions = [];
            const usedIndices = new Set();
            
            while (testQuestions.length < words.length && usedIndices.size < words.length) {
                const randomIndex = Math.floor(Math.random() * words.length);
                if (!usedIndices.has(randomIndex)) {
                    testQuestions.push(words[randomIndex]);
                    usedIndices.add(randomIndex);
                }
            }
            
            showQuestion();
        }

        function showFlashcards() {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏ –∏ —Å–∫—Ä—ã–≤–∞–µ–º —Ç–µ—Å—Ç –∏ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–ª–æ–≤
            document.getElementById('flashcardsSection').style.display = 'block';
            document.getElementById('testSection').style.display = 'none';
            document.getElementById('spellingSection').style.display = 'none';
        }

        function showQuestion() {
            if (currentQuestion >= testQuestions.length) {
                showTestResults();
                return;
            }

            const question = testQuestions[currentQuestion];
            const isRussianToEnglish = Math.random() > 0.5;
            
            const questionText = document.getElementById('questionText');
            const answerOptions = document.getElementById('answerOptions');
            const testResult = document.getElementById('testResult');
            const nextBtn = document.getElementById('nextBtn');
            
            // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            testResult.textContent = '';
            testResult.className = 'test-result';
            nextBtn.style.display = 'none';
            
            // –§–æ—Ä–º–∏—Ä—É–µ–º –≤–æ–ø—Ä–æ—Å
            if (isRussianToEnglish) {
                questionText.textContent = `What's the English for: "${question.russian}"?`;
            } else {
                questionText.textContent = `What's the Russian for: "${question.english}"?`;
            }
            
            // –§–æ—Ä–º–∏—Ä—É–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤
            const correctAnswer = isRussianToEnglish ? question.english : question.russian;
            
            // –°–æ–∑–¥–∞–µ–º –º–∞—Å—Å–∏–≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤, –∏—Å–∫–ª—é—á–∞—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
            const incorrectAnswers = [];
            const usedAnswers = new Set([correctAnswer]);
            
            while (incorrectAnswers.length < 3 && usedAnswers.size < words.length + 1) {
                const randomWord = words[Math.floor(Math.random() * words.length)];
                const potentialAnswer = isRussianToEnglish ? randomWord.english : randomWord.russian;
                
                if (!usedAnswers.has(potentialAnswer)) {
                    incorrectAnswers.push(potentialAnswer);
                    usedAnswers.add(potentialAnswer);
                }
            }
            
            const allOptions = [correctAnswer, ...incorrectAnswers].sort(() => Math.random() - 0.5);
            
            answerOptions.innerHTML = '';
            allOptions.forEach(option => {
                const button = document.createElement('button');
                button.className = 'answer-option';
                button.textContent = option;
                button.onclick = () => checkAnswer(option, correctAnswer, button);
                answerOptions.appendChild(button);
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏
            updateTestProgress();
        }

        function checkAnswer(selectedAnswer, correctAnswer, buttonElement) {
            const isCorrect = selectedAnswer === correctAnswer;
            const testResult = document.getElementById('testResult');
            const nextBtn = document.getElementById('nextBtn');
            const allButtons = document.querySelectorAll('.answer-option');
            
            // –û—Ç–∫–ª—é—á–∞–µ–º –≤—Å–µ –∫–Ω–æ–ø–∫–∏
            allButtons.forEach(btn => btn.classList.add('disabled'));
            
            // –ü–æ–º–µ—á–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç—ã
            allButtons.forEach(btn => {
                if (btn.textContent === correctAnswer) {
                    btn.classList.add('correct');
                } else if (btn === buttonElement && !isCorrect) {
                    btn.classList.add('incorrect');
                }
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            if (isCorrect) {
                correctAnswers++;
                testResult.textContent = '‚úÖ Correct!';
                testResult.className = 'test-result correct';
            } else {
                testResult.textContent = `‚ùå Wrong. The right answer is: ${correctAnswer}`;
                testResult.className = 'test-result incorrect';
            }
            
            userAnswers.push({
                question: testQuestions[currentQuestion],
                selectedAnswer,
                correctAnswer,
                isCorrect
            });
            
            nextBtn.style.display = 'block';
            updateTestProgress();
        }

        function nextQuestion() {
            currentQuestion++;
            showQuestion();
        }

        function updateTestProgress() {
            const testScore = document.getElementById('testScore');
            const questionCounter = document.getElementById('questionCounter');
            
            testScore.textContent = `Right answers: ${correctAnswers} from ${Math.min(currentQuestion + 1, testQuestions.length)}`;
            questionCounter.textContent = `Question ${currentQuestion + 1} from ${testQuestions.length}`;
        }

        function showTestResults() {
            const questionCard = document.getElementById('questionCard');
            const percentage = Math.round((correctAnswers / testQuestions.length) * 100);
            
            let resultEmoji = 'üéâ';
            let resultText = 'Fantastic!';
            let resultColor = '#38a169';
            
            if (percentage < 50) {
                resultEmoji = 'üìö';
                resultText = 'Need more learning';
                resultColor = '#e53e3e';
            } else if (percentage < 80) {
                resultEmoji = 'üëç';
                resultText = 'Good!';
                resultColor = '#d69e2e';
            }
            
            questionCard.innerHTML = `
                <div class="final-result" style="color: ${resultColor};">
                    <div class="result-emoji">${resultEmoji}</div>
                    <div class="result-title">${resultText}</div>
                    <div class="result-score">
                        Your score is: ${correctAnswers} from ${testQuestions.length} (${percentage}%)
                    </div>
                </div>
            `;

            // –û–±–Ω–æ–≤–ª—è–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Å—á–µ—Ç—á–∏–∫
            document.getElementById('testScore').textContent = `Right answers: ${correctAnswers} from ${testQuestions.length}`;
            document.getElementById('questionCounter').textContent = `Test is over!`;
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å–ª–æ–≤
        function startSpelling() {
            // –°–∫—Ä—ã–≤–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–µ–∫—Ü–∏—é —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å–ª–æ–≤
            document.getElementById('flashcardsSection').style.display = 'none';
            document.getElementById('testSection').style.display = 'none';
            document.getElementById('spellingSection').style.display = 'block';
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ
            currentSpellingWord = 0;
            spellingCorrectAnswers = 0;
            spellingWords = [...words].sort(() => Math.random() - 0.5);
            isSpellingCorrect = false;
            
            showSpellingWord();
        }

        function showSpellingWord() {
            if (currentSpellingWord >= spellingWords.length) {
                showSpellingResults();
                return;
            }

            const word = spellingWords[currentSpellingWord];
            
            const spellingQuestion = document.getElementById('spellingQuestion');
            const spellingArea = document.getElementById('spellingArea');
            const spellingInput = document.getElementById('spellingInput');
            const spellingResult = document.getElementById('spellingResult');
            const spellingNextBtn = document.getElementById('spellingNextBtn');
            const autoCheck = document.getElementById('autoCheck');
            
            // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            spellingResult.textContent = '';
            spellingResult.className = 'spelling-result';
            spellingNextBtn.style.display = 'none';
            autoCheck.style.display = 'block';
            isSpellingCorrect = false;
            
            // –§–æ—Ä–º–∏—Ä—É–µ–º –≤–æ–ø—Ä–æ—Å - —Ç–æ–ª—å–∫–æ –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ —Å–ª–æ–≤–∞
            spellingQuestion.textContent = `Make up the English word for: "${word.russian}"`;
            currentWordLetters = word.english.toUpperCase().split('');
            
            // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –±—É–∫–≤—ã
            const shuffledLetters = [...currentWordLetters].sort(() => Math.random() - 0.5);
            selectedLetters = [];
            
            // –°–æ–∑–¥–∞–µ–º –æ–±–ª–∞—Å—Ç—å —Å –±—É–∫–≤–∞–º–∏
            spellingArea.innerHTML = '';
            shuffledLetters.forEach((letter, index) => {
                const letterElement = document.createElement('div');
                letterElement.className = 'spelling-letter';
                letterElement.textContent = letter;
                letterElement.dataset.letter = letter;
                letterElement.dataset.index = index;
                letterElement.onclick = () => selectLetter(letter, letterElement);
                spellingArea.appendChild(letterElement);
            });
            
            // –°–æ–∑–¥–∞–µ–º –æ–±–ª–∞—Å—Ç—å –¥–ª—è –≤–≤–æ–¥–∞ —Å–ª–æ–≤–∞
            spellingInput.innerHTML = '';
            for (let i = 0; i < currentWordLetters.length; i++) {
                const slot = document.createElement('div');
                slot.className = 'spelling-slot';
                slot.dataset.index = i;
                slot.onclick = () => deselectLetter(i);
                spellingInput.appendChild(slot);
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏
            updateSpellingProgress();
        }

        function selectLetter(letter, element) {
            if (element.classList.contains('used') || isSpellingCorrect) return;
            
            // –ù–∞—Ö–æ–¥–∏–º –ø–µ—Ä–≤—ã–π —Å–≤–æ–±–æ–¥–Ω—ã–π —Å–ª–æ—Ç
            const slots = document.querySelectorAll('.spelling-slot');
            let emptySlot = null;
            
            for (let slot of slots) {
                if (!slot.classList.contains('filled')) {
                    emptySlot = slot;
                    break;
                }
            }
            
            if (emptySlot) {
                // –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
                element.classList.add('moving');
                setTimeout(() => {
                    element.classList.remove('moving');
                }, 500);
                
                // –ü–æ–º–µ—á–∞–µ–º –±—É–∫–≤—É –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—É—é
                element.classList.add('used');
                
                // –î–æ–±–∞–≤–ª—è–µ–º –±—É–∫–≤—É –≤ —Å–ª–æ—Ç
                emptySlot.textContent = letter;
                emptySlot.classList.add('filled');
                emptySlot.dataset.letter = letter;
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –±—É–∫–≤–µ
                selectedLetters.push({
                    letter,
                    slotIndex: parseInt(emptySlot.dataset.index),
                    element
                });
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å–ª–∏ –≤—Å–µ –±—É–∫–≤—ã —Ä–∞—Å—Å—Ç–∞–≤–ª–µ–Ω—ã
                checkSpellingAuto();
            }
        }

        function deselectLetter(slotIndex) {
            if (isSpellingCorrect) return;
            
            const slot = document.querySelector(`.spelling-slot[data-index="${slotIndex}"]`);
            
            if (slot.classList.contains('filled')) {
                const letter = slot.dataset.letter;
                
                // –ù–∞—Ö–æ–¥–∏–º —ç–ª–µ–º–µ–Ω—Ç –±—É–∫–≤—ã –∏ —É–±–∏—Ä–∞–µ–º –ø–æ–º–µ—Ç–∫—É "used"
                const letterElements = document.querySelectorAll(`.spelling-letter[data-letter="${letter}"]`);
                for (let letterElement of letterElements) {
                    if (letterElement.classList.contains('used')) {
                        letterElement.classList.remove('used');
                        break;
                    }
                }
                
                // –û—á–∏—â–∞–µ–º —Å–ª–æ—Ç
                slot.textContent = '';
                slot.classList.remove('filled');
                delete slot.dataset.letter;
                
                // –£–¥–∞–ª—è–µ–º –±—É–∫–≤—É –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö
                selectedLetters = selectedLetters.filter(item => item.slotIndex !== slotIndex);
            }
        }

        function checkSpellingAuto() {
            if (selectedLetters.length === currentWordLetters.length) {
                const currentWord = spellingWords[currentSpellingWord];
                const correctWord = currentWord.english.toUpperCase();
                
                // –°–æ–±–∏—Ä–∞–µ–º —Å–ª–æ–≤–æ –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –±—É–∫–≤
                const userWord = selectedLetters
                    .sort((a, b) => a.slotIndex - b.slotIndex)
                    .map(item => item.letter)
                    .join('');
                
                const spellingResult = document.getElementById('spellingResult');
                const spellingNextBtn = document.getElementById('spellingNextBtn');
                const autoCheck = document.getElementById('autoCheck');
                
                if (userWord === correctWord) {
                    spellingResult.textContent = '‚úÖ Correct! Well done!';
                    spellingResult.className = 'spelling-result correct';
                    spellingCorrectAnswers++;
                    isSpellingCorrect = true;
                    spellingNextBtn.style.display = 'block';
                    autoCheck.style.display = 'none';
                } else {
                    spellingResult.textContent = '‚ùå Try again! Check the word order.';
                    spellingResult.className = 'spelling-result incorrect';
                }
                
                updateSpellingProgress();
            }
        }

        function nextSpellingWord() {
            currentSpellingWord++;
            showSpellingWord();
        }

        function updateSpellingProgress() {
            const spellingScore = document.getElementById('spellingScore');
            const spellingCounter = document.getElementById('spellingCounter');
            
            spellingScore.textContent = `Right answers: ${spellingCorrectAnswers} from ${Math.min(currentSpellingWord + 1, spellingWords.length)}`;
            spellingCounter.textContent = `Word ${currentSpellingWord + 1} from ${spellingWords.length}`;
        }

        function showSpellingResults() {
            const spellingContainer = document.querySelector('.spelling-container');
            const percentage = Math.round((spellingCorrectAnswers / spellingWords.length) * 100);
            
            let resultEmoji = 'üéâ';
            let resultText = 'Fantastic spelling!';
            let resultColor = '#38a169';
            
            if (percentage < 50) {
                resultEmoji = 'üìö';
                resultText = 'Need more practice';
                resultColor = '#e53e3e';
            } else if (percentage < 80) {
                resultEmoji = 'üëç';
                resultText = 'Good spelling!';
                resultColor = '#d69e2e';
            }
            
            spellingContainer.innerHTML = `
                <div class="final-result" style="color: ${resultColor};">
                    <div class="result-emoji">${resultEmoji}</div>
                    <div class="result-title">${resultText}</div>
                    <div class="result-score">
                        Your score is: ${spellingCorrectAnswers} from ${spellingWords.length} (${percentage}%)
                    </div>
                    <div class="spelling-controls">
                        <button class="btn" onclick="startSpelling()">üîÑ Try again</button>
                        <button class="btn" onclick="showFlashcards()">üìö Back to cards</button>
                    </div>
                </div>
            `;

            // –û–±–Ω–æ–≤–ª—è–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Å—á–µ—Ç—á–∏–∫
            document.getElementById('spellingScore').textContent = `Right answers: ${spellingCorrectAnswers} from ${spellingWords.length}`;
            document.getElementById('spellingCounter').textContent = `Exercise is over!`;
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        createCards();
    </script>
</body>
</html>
